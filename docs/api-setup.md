# 百度天气API配置指南

## 概述

本项目使用百度地图开放平台的天气API服务获取天气数据。为了正常使用天气功能，您需要申请并配置百度地图API密钥。

## 申请API密钥

### 1. 注册百度地图开放平台账号

访问 [百度地图开放平台](https://lbsyun.baidu.com/) 并注册账号。

### 2. 创建应用

1. 登录后进入控制台
2. 点击「创建应用」
3. 填写应用信息：
   - 应用名称：天气预报应用
   - 应用类型：浏览器端
   - 启用服务：勾选「天气服务」

### 3. 获取API密钥（AK）

创建应用后，系统会生成一个API密钥（AK），请妥善保存。

## 配置项目

### 1. 创建环境变量文件

在项目根目录创建 `.env` 文件：

```bash
cp .env.example .env
```

### 2. 配置API密钥

编辑 `.env` 文件，将您的API密钥填入：

```env
# 百度地图API密钥
VITE_BAIDU_AK=您的真实API密钥

# 开发环境配置
VITE_APP_ENV=development
```

### 3. 重启开发服务器

```bash
npm run dev
```

## 常见问题排查

### 1. API调用返回错误

**问题现象**：控制台显示API调用失败或返回错误状态码

**可能原因**：
- API密钥未配置或配置错误
- API密钥权限不足（未开通天气服务）
- 请求频率超限
- 网络连接问题

**解决方案**：
1. 检查 `.env` 文件中的 `VITE_BAIDU_AK` 是否正确
2. 确认百度地图控制台中已开通天气服务权限
3. 检查API调用频率是否超限
4. 查看浏览器控制台的详细错误信息

### 2. 跨域问题

**问题现象**：浏览器控制台显示CORS错误

**解决方案**：
- 开发环境：项目已配置代理，应该不会出现跨域问题
- 生产环境：需要配置服务器代理或使用JSONP方式调用

### 3. 数据不准确

**可能原因**：
- 地理位置获取失败，使用了默认位置（北京）
- API返回的区域ID不正确
- 缓存数据过期

**解决方案**：
1. 检查浏览器是否允许获取地理位置
2. 查看控制台日志，确认获取的经纬度是否正确
3. 清除浏览器缓存并刷新页面

## 调试信息

项目已内置详细的调试日志，打开浏览器控制台可以看到：

- 📍 地理位置获取信息
- 🏙️ 区域ID信息
- 🌐 API请求URL
- 🔑 使用的API密钥（部分显示）
- 📡 API响应数据
- ✅ 数据来源（真实API或模拟数据）

## API限制说明

- **调用频率**：免费版有调用次数限制，请合理使用
- **服务范围**：支持全国范围的天气查询
- **数据更新**：天气数据每小时更新一次

## 技术支持

如果遇到问题，请：

1. 查看浏览器控制台的错误信息
2. 检查百度地图开放平台控制台的API调用统计
3. 参考百度地图开放平台的官方文档

---

**注意**：请不要将API密钥提交到代码仓库中，`.env` 文件已添加到 `.gitignore` 中。